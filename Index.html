<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Score Tracker - Keep score of a game</title>

    <link rel="stylesheet" type="text/css" href="../../Content/bootstrap.min.css" />
    <link rel="stylesheet" type="text/css" href="../../Content/font-awesome.min.css" />

    <script src="Scripts/angular.min.js"></script>
    <script src="Scripts/angular-ui/ui-bootstrap.min.js"></script>
    <script src="Scripts/angular-ui/ui-bootstrap-tpls.min.js"></script>
    <script src="~/Scripts/ScoreTracker/ScoreTracker.js"></script>
</head>
<body>

    <div class="container" style="padding-top:25px;">
        <div class="row" ng-app="scoreTrackerApp" ng-controller="scoreTrackerController">
            <div class="row">

                <div class="col-sm-12">

                    <div class="row">
                        <div class="col-sm-4">
                            <h3> <label class="">Game: </label><span> {{currentGame.Name}}</span></h3>
                        </div>
                        <div class="col-sm-4"><button class="btn btn-primary" ng-click="createNewGame()">New Game</button></div>
                        <div class="col-sm-4"><button class="btn btn-primary" ng-disabled="gameList.length < 1" ng-click="manageGames()">Manage Games</button></div>
                    </div>
                    <div ng-if="isGameLoaded()">
                        <hr />
                        <div class="row">
                            <div class="col-sm-12">
                                <table class="table table-sm">
                                    <thead>
                                        <tr>
                                            <th class="col-xs-3">Player</th>
                                            <th class="col-xs-3">Current Points</th>
                                            <th class="col-xs-3">Total Points</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr ng-repeat="player in currentGame.Players">
                                            <td class="">{{player.Name}}</td>
                                            <td class="">
                                                <div class="form-group col-sm-8">
                                                    <input class="form-control" type="number" placeholder="0"
                                                           ng-model="player.CurrentScore" />
                                                </div>
                                            </td>
                                            <td>{{getTotalPointsForPlayer(player.Id)}}</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <div class="row form-group">
                            <div class="col-sm-2"><button class="btn btn-primary" ng-click="saveCurrentPoints()">Save Points</button></div>
                            <div class="col-sm-2"><button class="btn btn-primary" ng-click="addPlayer()">Add Player(s)</button></div>
                            <div class="col-sm-2"><button class="btn btn-primary" ng-click="clearAllPoints()">Reset Game</button></div>


                        </div>
                        <hr />
                        <h3>Rounds({{getNumberOfRounds()}})</h3>

                        <div class="row">
                            <div class="col-sm-12">

                                <div class="row">
                                    <div class="col-xs-2" ng-repeat="player in currentGame.Players">
                                        <h4 class="text-center">{{player.Name}}</h4>
                                        <div class="text-center" ng-repeat="round in currentGame.Rounds | orderBy : round.Id">
                                            <span>{{getPlayerRoundScore(player.Id, round.Id)}}</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            @*New Game Modal*@
            <script type="text/ng-template" id="newGameModal.html">
                <div class="modal-header">
                    <button type="button" class="close" ng-click="closeModal()">&times;</button>
                    <h4 class="modal-title">New Game</h4>
                </div>
                <div class="modal-body">

                    <div class="form-group col-sm-offset-1">
                        <label for="newGameName">Game Name: </label>
                        <input class="form-control" required type="text" id="newGameName" ng-model="newGame.Name" />
                    </div>

                    <div class="form-group col-sm-offset-1" ng-repeat="player in newGame.Players">
                        <label>
                            Player: <input class="form-control" type="text" required min="2" ng-model="player.Name" />
                        </label>
                    </div>

                    <div class="form-group">
                        <button class="btn btn-primary col-sm-offset-6" ng-click="createNewPlayer(newGame, newPlayerName)">Add Player</button>
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" ng-click="saveNewGame()">Save</button>
                    <button type="button" class="btn btn-primary" ng-click="closeModal()">Cancel</button>
                </div>
            </script>
            @*Add Player Modal*@
            <script type="text/ng-template" id="addPlayerModal.html">
                <div class="modal-body form-inline">
                    <div class="form-group">
                        <label>
                            Player: <input class="form-control" type="text" required min="2" ng-model="newPlayerName" />
                        </label>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" ng-click="createNewPlayer(currentGame, newPlayerName, true)">Save</button>
                    <button type="button" class="btn btn-primary" ng-click="closeModal()">Cancel</button>
                </div>

            </script>
            @*Load Game Modal*@
            <script type="text/ng-template" id="manageGameModal.html">
                <div class="modal-body">
                    <h3>Games</h3>

                    <div class="row" ng-repeat="game in gameList">
                        <div class="col-xs-3">{{game.Name}}</div>
                        <div class="col-xs-2"><button type="button" class="btn btn-primary" ng-click="loadGame(game)">Load</button></div>
                        <div class="col-xs-2"><button type="button" class="btn btn-primary" ng-click="deleteGame(game)">Delete</button></div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" ng-click="closeModal()">Cancel</button>
                </div>

            </script>

        </div> @*End of controller*@
    </div>







</body>
</html>